swagger: "2.0"
info:
  title: github/chapool/go-wallet
  version: 0.1.0
paths:
  /api/v1/wallet/create:
    post:
      summary: Create wallet
      operationId: PostCreateWalletRoute
      description: |-
        Create a wallet for the authenticated user on the specified chain.
        If the user already has a wallet on this chain, returns the existing wallet.
      tags:
        - wallet
      security:
        - Bearer: []
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "../definitions/wallet.yml#/definitions/PostCreateWalletPayload"
      responses:
        "200":
          description: Wallet created or retrieved successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/CreateWalletResponse"
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPValidationError"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
  
  /api/v1/wallet/address:
    get:
      summary: Get wallet address
      operationId: GetWalletAddressRoute
      description: |-
        Get the wallet address for the authenticated user on the specified chain.
      tags:
        - wallet
      security:
        - Bearer: []
      produces:
        - application/json
      parameters:
        - name: chain_id
          in: query
          type: integer
          description: Chain ID (1 for Ethereum Mainnet, 137 for Polygon, 56 for BSC, etc.)
          required: true
      responses:
        "200":
          description: Wallet address retrieved successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/GetWalletAddressResponse"
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPValidationError"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "404":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
  
  /api/v1/wallet/list:
    get:
      summary: List all wallets
      operationId: GetWalletListRoute
      description: |-
        List all wallets for the authenticated user across all chains.
      tags:
        - wallet
      security:
        - Bearer: []
      produces:
        - application/json
      responses:
        "200":
          description: Wallet list retrieved successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/GetWalletListResponse"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
  
  /api/v1/wallet/sign-transaction:
    post:
      summary: Sign transaction
      operationId: PostSignTransactionRoute
      description: |-
        Sign an EVM transaction (EIP-1559). This is a test endpoint for transaction signing.
      tags:
        - wallet
      security:
        - Bearer: []
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "../definitions/wallet.yml#/definitions/PostSignTransactionPayload"
      responses:
        "200":
          description: Transaction signed successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/SignTransactionResponse"
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPValidationError"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
  
  /api/v1/wallet/chains:
    get:
      summary: Get supported chains
      operationId: GetChainsRoute
      description: |-
        Get list of supported EVM chains.
      tags:
        - wallet
      security:
        - Bearer: []
      produces:
        - application/json
      responses:
        "200":
          description: Chains retrieved successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/GetChainsResponse"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
  
  /api/v1/wallet/deposits:
    get:
      summary: Get deposit records
      operationId: GetDepositsRoute
      description: |-
        Get deposit records for the authenticated user.
        Supports filtering by chain_id and status.
      tags:
        - wallet
      security:
        - Bearer: []
      produces:
        - application/json
      parameters:
        - name: chain_id
          type: integer
          in: query
          required: false
          description: Chain ID (1 for Ethereum Mainnet, 137 for Polygon, 56 for BSC, etc.)
        - name: status
          type: string
          in: query
          required: false
          description: Filter by transaction status
          enum: [confirmed, safe, finalized, failed]
        - $ref: "../definitions/common.yml#/parameters/offsetParam"
        - $ref: "../definitions/common.yml#/parameters/limitParam"
      responses:
        "200":
          description: List of deposit records
          schema:
            $ref: "../definitions/wallet.yml#/definitions/GetDepositsResponse"
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPValidationError"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
  
  /api/v1/wallet/deposits/pending:
    get:
      summary: Get pending deposit balances
      operationId: GetPendingDepositsRoute
      description: |-
        Get pending deposit balances grouped by token symbol for the authenticated user.
        Returns deposits with status 'confirmed' or 'safe' (not yet finalized).
      tags:
        - wallet
      security:
        - Bearer: []
      produces:
        - application/json
      parameters:
        - name: chain_id
          type: integer
          in: query
          required: false
          description: Chain ID (1 for Ethereum Mainnet, 137 for Polygon, 56 for BSC, etc.)
      responses:
        "200":
          description: Pending deposit balances retrieved successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/GetPendingDepositsResponse"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
  
  /api/v1/wallet/balance/pending:
    get:
      summary: Get pending deposit balance total
      operationId: GetPendingDepositBalanceRoute
      description: |-
        Get total pending deposit balance for the authenticated user.
        Returns the sum of all deposits with status 'pending' or 'confirmed' (not yet finalized).
        This is the balance that is still being confirmed on the blockchain.
      tags:
        - wallet
      security:
        - Bearer: []
      produces:
        - application/json
      parameters:
        - name: chain_id
          type: integer
          in: query
          required: false
          description: Chain ID (1 for Ethereum Mainnet, 137 for Polygon, 56 for BSC, etc.)
      responses:
        "200":
          description: Pending deposit balance retrieved successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/PendingDepositBalanceResponse"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
  
  /api/v1/wallet/balance/total:
    get:
      summary: Get total balance
      operationId: GetTotalBalanceRoute
      description: |-
        Get total finalized balance for the authenticated user.
        Returns the sum of all finalized credits (deposits that have been confirmed and finalized).
      tags:
        - wallet
      security:
        - Bearer: []
      produces:
        - application/json
      parameters:
        - name: chain_id
          type: integer
          in: query
          required: false
          description: Chain ID (1 for Ethereum Mainnet, 137 for Polygon, 56 for BSC, etc.)
      responses:
        "200":
          description: Total balance retrieved successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/TotalBalanceResponse"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
  
  /api/v1/wallet/balance/tokens:
    get:
      summary: Get balance by token
      operationId: GetBalanceByTokenRoute
      description: |-
        Get balance breakdown by token for the authenticated user.
        Returns a list of all tokens with their finalized balances.
      tags:
        - wallet
      security:
        - Bearer: []
      produces:
        - application/json
      parameters:
        - name: chain_id
          type: integer
          in: query
          required: false
          description: Chain ID (1 for Ethereum Mainnet, 137 for Polygon, 56 for BSC, etc.)
      responses:
        "200":
          description: Balance by token retrieved successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/GetBalanceByTokenResponse"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"

  /api/v1/wallet/withdraw:
    post:
      summary: Request withdraw
      operationId: PostWithdrawRoute
      description: |-
        Request a withdrawal from the wallet.
        Checks balance and creates a withdrawal request.
      tags:
        - wallet
      security:
        - Bearer: []
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "../definitions/wallet.yml#/definitions/PostWithdrawPayload"
      responses:
        "200":
          description: Withdraw request created successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/WithdrawResponse"
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPValidationError"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"

  /api/v1/wallet/withdraws:
    get:
      summary: Get withdraw history
      operationId: GetWithdrawsRoute
      description: |-
        Get withdrawal history for the authenticated user.
      tags:
        - wallet
      security:
        - Bearer: []
      produces:
        - application/json
      parameters:
        - name: chain_id
          type: integer
          in: query
          required: false
          description: Chain ID
        - name: token_id
          type: integer
          in: query
          required: false
          description: Token ID
        - name: status
          type: string
          in: query
          required: false
          description: Filter by status
        - $ref: "../definitions/common.yml#/parameters/offsetParam"
        - $ref: "../definitions/common.yml#/parameters/limitParam"
      responses:
        "200":
          description: Withdraw history retrieved successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/GetWithdrawsResponse"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"

  /api/v1/wallet/withdraw/{withdrawId}/approve:
    post:
      summary: Approve withdraw request (Admin only)
      operationId: PostApproveWithdrawRoute
      description: |-
        Approve a withdraw request and process it.
        Only admin users can approve withdraw requests.
      tags:
        - wallet
      security:
        - Bearer: []
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: withdrawId
          type: string
          format: uuid
          in: path
          required: true
          description: Withdraw ID to approve
      responses:
        "200":
          description: Withdraw approved and processed successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/WithdrawResponse"
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPValidationError"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "403":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "404":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"

  /api/v1/wallet/withdraw/{withdrawId}/reject:
    post:
      summary: Reject withdraw request (Admin only)
      operationId: PostRejectWithdrawRoute
      description: |-
        Reject a withdraw request.
        Only admin users can reject withdraw requests.
      tags:
        - wallet
      security:
        - Bearer: []
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: withdrawId
          type: string
          format: uuid
          in: path
          required: true
          description: Withdraw ID to reject
        - name: body
          in: body
          required: false
          schema:
            $ref: "../definitions/wallet.yml#/definitions/PostRejectWithdrawPayload"
      responses:
        "200":
          description: Withdraw rejected successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/WithdrawResponse"
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPValidationError"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "403":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "404":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"

  /api/v1/wallet/collect:
    post:
      summary: Trigger manual collection
      operationId: PostCollectRoute
      description: |-
        Manually trigger collection for a specific wallet.
        Moves funds from user wallet to hot wallet.
      tags:
        - wallet
      security:
        - Bearer: []
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "../definitions/wallet.yml#/definitions/PostCollectPayload"
      responses:
        "200":
          description: Collection initiated successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/CollectResponse"
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPValidationError"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"

  /api/v1/wallet/collects:
    get:
      summary: Get collect history
      operationId: GetCollectsRoute
      description: |-
        Get collection history for the authenticated user.
        Returns all collect transactions (type='collect') for user wallets.
      tags:
        - wallet
      security:
        - Bearer: []
      produces:
        - application/json
      parameters:
        - name: chain_id
          type: integer
          in: query
          required: false
          description: Chain ID
        - name: status
          type: string
          in: query
          required: false
          description: Filter by transaction status
          enum: [confirmed, safe, finalized, failed]
        - $ref: "../definitions/common.yml#/parameters/offsetParam"
        - $ref: "../definitions/common.yml#/parameters/limitParam"
      responses:
        "200":
          description: Collect history retrieved successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/GetCollectsResponse"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"

  /api/v1/wallet/rebalance:
    post:
      summary: Trigger manual rebalance
      operationId: PostRebalanceRoute
      description: |-
        Manually trigger rebalance between two hot wallets.
        Moves funds from one hot wallet to another on the same chain.
      tags:
        - wallet
      security:
        - Bearer: []
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "../definitions/wallet.yml#/definitions/PostRebalancePayload"
      responses:
        "200":
          description: Rebalance completed successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/RebalanceResponse"
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPValidationError"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"

  /api/v1/wallet/hot-wallet:
    post:
      summary: Create hot wallet
      operationId: PostCreateHotWalletRoute
      description: |-
        Create a hot wallet on the specified chain.
        Only admin users can create hot wallets.
      tags:
        - wallet
      security:
        - Bearer: []
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "../definitions/wallet.yml#/definitions/PostCreateHotWalletPayload"
      responses:
        "200":
          description: Hot wallet created successfully
          schema:
            $ref: "../definitions/wallet.yml#/definitions/CreateHotWalletResponse"
        "400":
          description: PublicHTTPValidationError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPValidationError"
        "401":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "403":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"
        "500":
          description: PublicHTTPError
          schema:
            $ref: "../definitions/errors.yml#/definitions/PublicHTTPError"

